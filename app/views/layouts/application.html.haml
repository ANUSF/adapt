!!! Strict
%html{html_attrs}
  - stripped = request.xhr? || params[:stripped]

  %head
    %meta{"http-equiv"=>"Content-Type", :content=>"text/html; charset=utf-8"}/
    %title= h(yield(:title) || "Untitled")
    - unless stripped
      - if params.has_key?('printer_friendly')
        = stylesheet_link_tag 'application-print', :media => 'all'
        %style{:type => "text/css"} body { padding: 2em; width: 80%; }
      - else
        = stylesheet_link_tag 'application'
        = stylesheet_link_tag 'application-print', :media => 'print'
      /[if IE]
        = stylesheet_link_tag 'ie-fixes', :media => 'all'
      = javascript_include_tag 'jquery-1.3.1', 'jquery.form'
      = javascript_include_tag 'jquery.djtch', 'application'
      = yield(:head)
  
  %body
    #top
      - unless stripped
        #navigation
          = image_tag "/images/minifantopleft.png"
          %ul
            - if current_user
              %li= link_to "View deposits", studies_path
              %li= link_to "Add study", new_study_path
              %li= link_to "Edit profile", edit_user_path(:current)
              %li= link_to "Logout", logout_path
            - else
              %li= link_to "Register", ENV['ASSDA_REGISTRATION_URL']
              %li= link_to "Login", login_path
    
      #main
        - unless stripped
          #header
            = image_tag "/images/minifantop.png"
            = image_tag "/images/assda-logo.png", :class => "logo"
            %div
              - if in_demo_mode
                ADAPT Prototype (Demo mode)
              - else
                ASSDA Deposit and Preservation Tool (Prototype)

        #content
          - flash.each do |name, msg|
            %div{ :id => "flash_#{name}" }= msg
      
          - if show_title? and not stripped
            %h1=h yield(:title)
            %hr
        
          #page= yield
  
    - unless stripped
      #footer
        Copyright 2010 ANUSF
        %br
        &mdash;
        %br
        Powered by Ruby on Rails
        = link_to "Printer style preview", url_for(:printer_friendly => 1)
